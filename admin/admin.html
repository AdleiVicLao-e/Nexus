<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Page</title>
    <link rel="stylesheet" href="../res/css/adminStyle.css">
    <link href="../assets/img/favicon.png" rel="icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <script src="../res/js/admin/javascript.js"></script>
    <script src="../res/js/admin/chart.min.js"></script>
</head>

<body>
    <header>
        <div class="logo">
            <img src="../assets/img/logo.png" alt="Saint Louis University Logo" style="width: 150px; height: auto;">
            Admin Dashboard
        </div>

        <div class="greetings">
            <img src="../res/images/user-image.png" alt="User Icon">
            <div class="greeting">
                <div class="curator">Hi, Curator!</div>
                <nav><a href="#home">Logout</a></nav>
            </div>
        </div>
    </header>

    <div class="main-container">
        <div class="left-container">
            <div class="analytics">
                <div class="col-md-8">
                    <div class="card card-round" id="cardToPrint">
                      <div class="card-header">
                        <div class="card-head-row">
                          <div class="card-title">Visitor Statistics</div>
                        </div>
                      </div>
                      <div class="card-body">
                        <div class="chart-container" style="min-height: 375px">
                          <canvas id="statisticsChart"></canvas>
                        </div>
                        <div id="myChartLegend"></div>
                      </div>
                    </div>
                  </div>
            </div>
            
        </div>

        <div class="right-container">
            <div class="artifacts">
                <div class="tabs">
                    <div class="tab active" onclick="openTab('search')">Search Artifact</div>
                    <div class="tab" onclick="openTab('add')">Add Artifact</div>
                    <div class="tab" onclick="openTab('add2')">Add Category</div>
                    <div class="tab" onclick="openTab('upload')">Upload Media</div>
                    <div class="tab" onclick="openTab('edit')">Edit Media</div>
                </div>

                <div id="search" class="tab-content active">
                    <div class="search-container">
                        <input type="text" class="search-input" placeholder="Search artifact..." oninput="searchArtifact()">
                        <button class="search-button" onclick="searchArtifact()">Search</button>
                    </div>
                    <button id="toggle-multi-select" onclick="toggleMultiSelect()">Enable Multi-Select</button>
                    <button id="delete-selected-button" style="display: none;" onclick="deleteSelectedArtifacts()">Delete Selected</button>

                    <div id="search-results"></div>

                </div>

                <!-- Edit Popup Window -->
                <div id="edit-modal" class="modal">
                    <div class="modal-content">
                        <span class="close-button" onclick="closeModal()">&times;</span>
                        <h2>Edit Artifact</h2>
                        <form id="edit-form">
                            <input type="hidden" id="artifact-id">
                            <label for="artifact-id">Artifact ID:</label>
                            <span id="artifact-id-display"></span><br>
                            <label for="editName">Name:</label>
                            <input type="text" id="editName" name="name"><br>
                            <label for="editSection">Section:</label>
                            <select id="editSection" name="section" onchange="fetchCatalogs(this.value)"></select><br>
                            <label for="editCatalog">Catalogue:</label>
                            <select id="editCatalog" name="catalog" onchange="fetchSubcatalogs(this.value)"></select><br>
                            <label for="editSubcatalog">Subcatalogue:</label>
                            <select id="editSubcatalog" name="subcatalog"></select><br>
                            <label for="description">Description:</label>
                            <textarea id="editDescription" name="description"></textarea><br>
                            <button type="button" onclick="saveChanges()">Save</button>
                        </form>
                    </div>
                </div>


                <div id="add" class="tab-content">
                    <div class="form-container">
                        <form action="/include/addArtifact.php" method="post"> <!--add database here i think??? .php, action="-here-" "/include/addArtifact.php"-->
                            <div class="form-group">
                                <label for="artifact-name">Artifact Name:</label>
                                <input type="text" id="artifact-name" name="artifact-name" required>
                            </div>

                            <div class="form-group">
                                <label for="section">Section:</label>
                                <select id="section" name="section" required>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="catalog">Catalog:</label>
                                <select id="catalog" name="catalog" required>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="sub-catalog">Sub Catalog:</label>
                                <select id="sub-catalog" name="sub-catalog" required>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="description">Description:</label>
                                <textarea id="description" name="description" required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="condition">Condition:</label>
                                <textarea id="condition" name="condition" required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="script">Virtual Avatar Script:</label>
                                <textarea id="script" name="script" required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="media-upload">Upload Media:</label>
                                <input type="file" id="media-upload" name="media-upload" accept="image/*,video/*">
                            </div>

                            <button type="submit">Add Artifact</button>
                        </form>
                    </div>
                </div>

                <div id="add2" class="tab-content">
                    <div class="form-container">
                        <form action="/include/addCategory.php" method="post"> <!--add database here i think??? .php, action="-here-" "/include/addArtifact.php"-->
                            <h3 style="text-align: center;">Add New Section</h3>

                            <!-- Form for Adding New Section -->
                            <div class="form-group">
                                <label for="create-new-section">New Section Title:</label>
                                <input type="text" id="create-new-section" name="new_section">
                            </div>
                            <div class="button-container">
                                <button type="submit" name="action" value="create_section" class="btn">Create Section</button>
                            </div>

                            <h1> </h1>
                            <hr>

                        <!-- Form for Adding New Catalog -->
                            <h3 style="text-align: center;">Add New Catalog</h3>

                            <div class="form-group">
                                <label for="create-select-section">Choose Section:</label>
                                <select id="create-select-section" name="section_id">
                                    <option value="">Select Section</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="create-new-catalog">New Catalog Name:</label>
                                <input type="text" id="create-new-catalog" name="new_catalog">
                            </div>

                            <div class="button-container">
                                <button type="submit" name="action" value="create_catalog" class="btn">Create Catalog</button>
                            </div>


                        <h1> </h1>
                            <hr>

                        <!-- Form for Adding New Sub Catalog -->
                            <h3 style="text-align: center;">Add New Subcatalog</h3>

                            <div class="form-group">
                                <label for="create-select-catalog">Choose Catalog:</label>
                                <select id="create-select-catalog" name="catalogue_id">
                                    <option value="">Select Catalog</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="create-new-subcatalog">New Subcatalog Name:</label>
                                <input type="text" id="create-new-subcatalog" name="new_subcatalog">
                            </div>

                            <div class="button-container">
                                <button type="submit" name="action" value="create_subcatalog" class="btn">Create Subcatalog</button>
                            </div>

                        </form>
                    </div>
                </div>

                <div id="upload" class="tab-content">
                    <div class="upload-container">
                        <form action="" method="post"> <!--add database here i think??? .php, action="-here-" "/include/addArtifact.php"-->
                            <div class="form-group">
                                <label for="media-upload">Upload Media:</label>
                                <input type="file" id="media-upload2" name="media-upload" accept="image/*,video/*">
                            </div>

                            <div class="form-group">
                                <label for="vid-title">Video Title:</label>
                                <input type="text" id="vid-title" name="vid-title" required>
                            </div>

                            <div class="form-group">
                                <label for="vid-description">Video Description:</label>
                                <textarea id="vid-description" name="vid-description" required></textarea>
                            </div>

                            <button type="submit" class="btn">Add New Video</button>
                        </form>
                    </div>
                </div>

                <div id="edit" class="tab-content">
                    <div class="edit-container">
                        <form action="" method="post"> <!--add database here i think??? .php, action="-here-" "/include/addArtifact.php"-->
                            <div class="form-group">
                                <label for="vid-select">Select Video:</label>
                                <select id="vid-select" name="vid-select" required>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="edit-vidtit">Edit Video Title:</label>
                                <input type="text" id="edit-vidtit" name="edit-vidtit" required>
                            </div>

                            <div class="form-group">
                                <label for="edit-videsc">Edit Video Description:</label>
                                <textarea id="edit-videsc" name="edit-videsc" required></textarea>
                            </div>

                            <div class="button-container">
                                <button type="submit" class="btn">Make Changes</button>
                                <button type="button" class="del-btn">Delete Video</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="popup">
        <div class="popup-section">
            <img src="../res/images/exit-icon.png" alt="Close" class="close">

            <div class="form-group">
                <label for="new-section">New Section Title:</label>
                <input type="text" id="add-new-section" name="new-section" required>
            </div>

            <div class="button-container">
                <button type="submit" class="btn">Create Section</button>
            </div>
        </div>

        <div class="popup-catalog">
            <img src="../res/images/exit-icon.png" alt="Close" class="close">

            <div class="form-group">
                <label for="new-section">Choose Section:</label>
                <select id="select-section" name="section" required>
                </select>
            </div>

            <div class="form-group">
                <label for="new-section">New Catalog Name:</label>
                <input type="text" id="add-new-catalog" name="new-catalog" required>
            </div>

            <div class="button-container">
                <button type="submit" class="btn">Create Catalog</button>
            </div>
        </div>

        <div class="popup-subcat">
            <img src="../res/images/exit-icon.png" alt="Close" class="close">

            <div class="form-group">
                <label for="add-new-catalog">Choose Catalog:</label>
                <select id="select-catalog" name="catalog" required>
                    <option value="">Select Catalog</option>
                </select>
            </div>

            <div class="form-group">
                <label for="new-section">New Sub Catalog Name:</label>
                <input type="text" id="new-section" name="new-sub-cat" required>
            </div>

            <div class="button-container">
                <button type="submit" class="btn">Create Sub Catalog</button>
            </div>
        </div>
    </div>
    <script src="/res/js/admin/admin.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('/include/get.php') // Adjust the path if necessary
                .then(response => response.json())
                .then(data => {
                    const sectionSelect = document.getElementById("create-select-section");
                    const sections = data.sections;

                    sections.forEach(section => {
                        const option = document.createElement("option");
                        option.value = section.section_id;
                        option.text = section.section_name;
                        sectionSelect.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error("Error fetching sections:", error);
                });
        });

        document.addEventListener("DOMContentLoaded", function() {
        fetch('/include/get.php') // Adjust the path if necessary
            .then(response => response.json())
            .then(data => {
                const catalogSelect = document.getElementById("create-select-catalog");
                const catalogues = data.catalogues;

                catalogues.forEach(catalog => {
                    const option = document.createElement("option");
                    option.value = catalog.catalogue_id;
                    option.text = catalog.catalogue_name;
                    catalogSelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error("Error fetching catalogues:", error);
            });
        });
    </script>
</body>
</html>
